<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" /><meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Courses â€” Crypto Training</title>
<link rel="icon" href="/logo.png">
<style>
  body{margin:0;font-family:system-ui;background:#071024;color:#e6eef8}
  header{padding:14px;background:linear-gradient(90deg,#06203a,#08304d);display:flex;align-items:center;gap:12px}
  .container{padding:18px;max-width:1000px;margin:18px auto}
  .video-card{background:#041328;padding:12px;border-radius:8px;margin-bottom:12px}
  video{width:100%;height:auto;border-radius:8px;outline:none}
  .hint{font-size:13px;opacity:0.9;margin-bottom:10px}
</style>
</head>
<body>
<header>
  <img src="https://i.postimg.cc/x1cLbZhh/IMG-20250812-WA0070.jpg" style="height:36px" alt="logo">
  <div style="font-weight:700">BEWISE TRADING AND INVESTMENT INSTITUTION</div>
</header>

<div class="container">
  <h2>Course Videos</h2>
  <div class="hint">Videos are view-only. Downloading or screen-record prevention cannot be fully enforced on the web; we make it harder by disabling right-click and nodownload controls.</div>
  <div id="videosList">Loading videos...</div>
</div>

<script>
(async function(){
  const RENDER_HOST = 'bewise-trading-and-investment-institution-k7ue.onrender.com';
  const RENDER_BASE = 'https://' + RENDER_HOST;
  const RENDER_API = RENDER_BASE + '/api';
  const API = (location.hostname === RENDER_HOST) ? '/api' : RENDER_API;

  async function apiFetch(path, opts = {}){
    const final = Object.assign({ credentials:'include' }, opts);
    const r = await fetch(API + path, final);
    if(r.status === 401 || r.status === 403){ alert('Session expired or not authorized'); window.location.href='/'; throw new Error('unauthorized'); }
    return r;
  }

  const listEl = document.getElementById('videosList');
  async function load(){
    listEl.textContent = 'Loading...';
    try {
      const r = await apiFetch('/videos');
      const j = await r.json();
      if(!Array.isArray(j)){ listEl.innerHTML = '<div>Error</div>'; return; }
      listEl.innerHTML = '';
      j.forEach(v => {
        const c = document.createElement('div');
        c.className = 'video-card';
        c.innerHTML = `<div style="font-weight:700;margin-bottom:8px">${v.title}</div>
          <video controls controlsList="nodownload noremoteplayback" preload="metadata" data-id="${v.id}">
            <source src="/stream/${v.id}" type="video/mp4">
            Your browser does not support the video element.
          </video>`;
        // disable context menu on video to make saving a bit harder
        c.querySelector('video').addEventListener('contextmenu', (e)=> e.preventDefault());
        listEl.appendChild(c);
      });
    } catch(e){
      console.error(e);
      listEl.innerHTML = '<div class="hint">Error loading videos or authorization required.</div>';
    }
  }
  await load();

  // Basic attempt to discourage PrintScreen key capture (not reliable)
  window.addEventListener('keydown', function(e){
    // F12, PrintScreen (PrintScreen cannot be reliably blocked)
    if(e.key === 'F12'){ e.preventDefault(); alert('Shortcut blocked'); }
  });

})();
</script>
</body>
</html>