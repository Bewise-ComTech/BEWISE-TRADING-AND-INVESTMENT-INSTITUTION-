<!-- dashboard.html
     Dashboard page (inline CSS + JS)
     Checks session and ensures the device fingerprint matches the allowed device.
     Shows two motivational messages (each preceded by an image) below the buttons.
     - Payment button color changed to yellow.
     - Buttons separated into their own flex.
     - Motivation blocks are side-by-side (image + quote) on wide screens and stacked on small screens.
     - Footer links made visible and styled.
     - Font Awesome added (icons added next to social link labels, original text preserved).
-->
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BEWISE TRADING AND INVESTMENT INSTITUTION</title>
<link rel="icon" href="/logo.png">

<!-- Font Awesome (added as requested) -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />

<style>
  html,body{ height:100%; margin:0; }
  body{
    margin:0;
    font-family:system-ui, "Segoe UI", Roboto, Arial, sans-serif;
    background:linear-gradient(180deg,#031025,#071024);
    color:#e6eef8;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    display:flex;
    flex-direction:column;
    min-height:100vh;
  }

  header{
    display:flex;
    align-items:center;
    gap:12px;
    padding:14px;
    background:linear-gradient(90deg,#06203a,#08304d);
  }
  .logo{ height:36px }
  .container{ padding:20px; max-width:1100px; margin:0 auto; width:100%; flex:1 0 auto; }

  .card{
    background:#062035;
    padding:28px;
    border-radius:14px;
    box-shadow:0 12px 30px rgba(2,6,23,0.6);
    display:flex;
    flex-direction:column;
    gap:18px;
    min-height:auto;
  }

  h2 { margin:0 0 6px 0; font-size:1.45rem; }
  p  { margin:0; opacity:0.92; text-align:center; max-width:820px; }

  #status{ margin-top:6px; opacity:0.9; font-size:0.95rem; text-align:center; }

  /* Buttons area separated into its own flex */
  .buttons-flex {
    width:100%;
    display:flex;
    justify-content:center;
    align-items:flex-start;
    gap:20px;
    flex-wrap:wrap;
  }

  .links {
    display:flex;
    flex-direction:column;
    gap:14px;
    width:360px;
    max-width:90%;
    align-items:stretch;
  }

  .links a, .links button {
    display:inline-flex;
    align-items:center;
    justify-content:center;
    padding:18px 22px;
    border-radius:14px;
    font-size:1.05rem;
    font-weight:900;
    text-decoration:none;
    border:0;
    cursor:pointer;
    box-shadow:0 12px 28px rgba(0,0,0,0.45);
    transition: transform .12s ease, box-shadow .12s ease;
    color:#042a2b; /* dark text for high contrast on bright buttons */
    letter-spacing:0.35px;
    text-align:center;
  }

  .links a:focus, .links button:focus {
    outline:4px solid rgba(255,255,255,0.06);
    outline-offset:4px;
  }

  .links a:hover, .links button:hover {
    transform: translateY(-4px);
    box-shadow:0 18px 40px rgba(0,0,0,0.55);
  }

  .courses-link {
    background: linear-gradient(90deg,#1e88ff 0%, #0b63d6 100%); /* blue */
    color: #fff;
  }
  /* Payment changed to yellow (requested) */
  .payment-link {
    background: linear-gradient(90deg,#ffd54f 0%, #ffb300 100%); /* yellow */
    color: #2b1f00;
  }
  .admin-link {
    background: linear-gradient(90deg,#34d399 0%, #10b981 100%);
    color:#04210b;
  }

  .testimonials-link {
    background: linear-gradient(90deg,#7ee3a6 0%, #4ade80 100%);
    color:#042616;
    font-weight:900;
    box-shadow:0 14px 36px rgba(2,6,23,0.20);
    opacity:1;
  }
  .testimonials-link[aria-disabled="true"]{
    pointer-events:none;
    cursor:default;
    filter: saturate(0.96);
    opacity:0.98;
  }

  button.logout {
    background: linear-gradient(90deg,#ff8a8a,#ef4444);
    color:#fff;
    padding:14px 18px;
    border-radius:14px;
    border:0;
    cursor:pointer;
    font-weight:800;
    font-size:1.05rem;
    box-shadow:0 12px 30px rgba(0,0,0,0.38);
    width:160px;
    align-self:center;
  }
  button.logout:hover { transform: translateY(-4px); }

  /* motivational section: each motivation is a flex row (image + quote) */
  .motivation-wrap {
    width:100%;
    max-width:980px;
    margin-top:6px;
    display:flex;
    flex-direction:column;
    gap:18px;
    align-items:stretch;
  }

  .motivation {
    display:flex;
    gap:18px;
    background:#04182c;
    border-radius:12px;
    padding:12px;
    box-shadow:0 8px 24px rgba(0,0,0,0.35);
    align-items:stretch;
    width:100%;
  }

  .motivation .img-col, .motivation .text-col {
    flex:1 1 50%;
    min-width:0;
  }

  .motivation img{
    width:100%;
    height:100%;
    display:block;
    object-fit:cover;
    border-radius:8px;
    max-height:620px;
  }

  .motivation p{
    text-align:justify;
    line-height:1.6;
    color:#dff8ff;
    margin:0;
    padding:4px 6px;
    overflow-wrap:break-word;
  }

  /* Footer styling (separate flex and more attractive links) */
  footer{
    margin-top:18px;
    padding:18px;
    background: linear-gradient(180deg,#021226,#04182c);
    border-top: 1px solid rgba(255,255,255,0.03);
    display:flex;
    flex-wrap:wrap;
    justify-content:space-between;
    align-items:center;
    gap:12px;
    color:#cfefff;
    flex-shrink:0;
  }

  .footer-left { display:flex; align-items:center; gap:12px; }
  .footer-right { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }

  .social a{
    display:inline-flex;
    align-items:center;
    justify-content:center;
    gap:8px;
    padding:8px 10px;
    border-radius:10px;
    background:rgba(255,255,255,0.04);
    text-decoration:none;
    color:inherit;
    font-weight:700;
    transition: transform .12s ease, background .12s ease;
  }
  .social a i { font-size:16px; }
  .social a:hover{ transform:translateY(-4px); background:rgba(255,255,255,0.08); }

  .back-top {
    padding:10px 14px;
    border-radius:10px;
    background:linear-gradient(90deg,#06b6d4,#0891b2);
    color:#042a2b;
    text-decoration:none;
    font-weight:800;
  }

  .credit { font-size:0.95rem; color:#9feaf6; }

  /* responsive: on small screens stack motivation blocks vertically */
  @media (max-width:920px){
    .motivation { flex-direction:column; }
    .motivation img{ max-height:260px; border-radius:8px; }
    .links { width:100%; }
    .buttons-flex { justify-content:center; }
    .card { padding:18px; }
  }

  @media (max-width:520px){
    .motivation img{ max-height:200px; }
    .links a, .links button { font-size:0.98rem; padding:14px 16px; }
    .logout { width:100%; }
  }
</style>
</head>
<body>
<header>
  <img src="/logo.png" class="logo" alt="logo">
  <div style="font-weight:700; color: green">BEWISE TRADING AND INVESTMENT INSTITUTION</div>
</header>

<div class="container">
  <div class="card">
    <h2 id="who">Welcome</h2>
    <p>Use the buttons below to access courses, payment or admin (if you are admin).</p>

    <!-- Buttons are in their own flex container (left for links, right for logout on wide screens) -->
    <div class="buttons-flex" role="region" aria-label="Main actions">
      <div class="links" role="navigation" aria-label="Primary links">
        <a class="courses-link" href="/course" id="coursesBtn" aria-label="Open Courses">Courses</a>
        <a class="payment-link" href="/payment" id="paymentBtn" aria-label="Open Payment">Payment</a>
        <!-- Admin link hidden by default; JS will reveal it for admins -->
        <a id="adminLink" class="admin-link" href="/admin" style="display:none" aria-label="Open Admin">Admin</a>
        <a class="testimonials-link" href="#" aria-disabled="true" title="Coming soon" aria-label="Testimonials coming soon">
          Testimonials — Coming soon
        </a>
      </div>

      <!-- Logout placed to the right on wide screens, below on narrow screens -->
      <div style="display:flex; align-items:center; justify-content:center; min-width:160px;">
        <button class="logout" id="logoutBtn" aria-label="Logout">Logout</button>
      </div>
    </div>

    <div id="status" aria-live="polite"></div>

    <!-- Motivational messages: each is a flex row (image + quote) -->
    <div class="motivation-wrap" aria-live="polite">
      <div class="motivation" id="motivation1">
        <div class="img-col">
          <img src="https://i.postimg.cc/kGmqwRnc/IMG-20250812-WA0070.jpg" alt="Inspiration image 1">
        </div>
        <div class="text-col">
          <p>
            Every successful trader started with a single step: the decision to learn. Trading crypto is less about chasing instant wins and more about building consistent habits — studying charts, learning risk management, and developing emotional discipline. Think of each lesson here as a tool: over time they stack into strategy, confidence, and real results. You will encounter ups and downs; that is normal. The best students turn every setback into a learning moment — analyzing what went wrong, adjusting their plan, and returning smarter. Stay patient. Keep journals of trades and decisions. Ask questions. Practice with small positions until your strategy and psychology align. This course is designed to give you reliable, practical building blocks — watch, rewatch, and apply. Your growth will be the sum of small, deliberate improvements repeated every day.
          </p>
        </div>
      </div>

      <div class="motivation" id="motivation2">
        <div class="img-col">
          <img src="https://i.postimg.cc/j5kSXSD3/behnam-norouzi-mp11-hr-QXf8-unsplash.jpg" alt="Inspiration image 2">
        </div>
        <div class="text-col">
          <p>
            You are not alone in this journey: a strong community and clear, consistent study beats shortcuts every time. As you deepen your knowledge, prioritize capital preservation and process over impulsive profits. Set realistic goals — daily study goals, weekly review goals, and monthly performance goals — and celebrate small wins. The true edge in trading comes from curiosity and persistence: read reliable sources, back-test ideas, and keep improving your mental game. When you feel overwhelmed, step back, revise your plan, and return with curiosity rather than fear. Use this platform to internalize sound trading habits, leverage the materials and videos uploaded by the instructor, and engage with the content thoughtfully. Over time, small disciplined actions compound into skill, confidence, and financial independence. Keep going — consistency is the one habit that separates learners from achievers.
          </p>
        </div>
      </div>
    </div>

  </div>
</div>

<footer>
  <div class="footer-left">
    <div style="display:flex; align-items:center; gap:12px;">
      <img src="/logo.png" alt="logo" style="height:40px; border-radius:8px;">
      <div>
        <div class="credit">BEWISE TRADING &amp; INVESTMENT INSTITUTION</div>
        <div style="font-size:0.85rem; opacity:0.85;">Account: <strong>8167542829</strong> (Palmpay) — Ezeh Ebube Chidubem</div>
      </div>
    </div>
  </div>

  <div class="footer-right">
    <div class="social" aria-label="Social links">
      <a href="https://facebook.com/profile.php?id=100081867991800" target="_blank" rel="noopener" title="Facebook"><i class="fab fa-facebook-f" aria-hidden="true"></i> FB</a>
      <a href="https://x.com/chidubemEz468?t=QhEOHmP-Gqc253LRMfbu_A&s=09" target="_blank" rel="noopener" title="X / Twitter"><i class="fab fa-x-twitter" aria-hidden="true"></i> X</a>
      <a href="https://wa.me/qr/JYPUQLHYHEZAA1" target="_blank" rel="noopener" title="WhatsApp"><i class="fab fa-whatsapp" aria-hidden="true"></i> WA</a>
      <a href="https://tiktok.com/@TraderDubem" target="_blank" rel="noopener" title="TikTok"><i class="fab fa-tiktok" aria-hidden="true"></i> TT</a>
    </div>

    <a class="back-top" href="#top" title="Back to top">Back To Top</a>
    <div style="min-width:8px"></div>
    <div class="credit">&copy; Developed By Dubem Tech</div>
  </div>
</footer>

<script>
(async function(){
  // compute fingerprint same as authentication page
  async function getFingerprint(){
    try {
      let uuid = localStorage.getItem('training_device_uuid');
      if(!uuid){
        uuid = crypto.randomUUID ? crypto.randomUUID() : ('u-'+Math.random().toString(36).slice(2));
        localStorage.setItem('training_device_uuid', uuid);
      }
      const parts = [
        navigator.userAgent || '',
        navigator.platform || '',
        (navigator.languages || []).join(','),
        screen.width + 'x' + screen.height + 'x' + screen.colorDepth,
        Intl.DateTimeFormat().resolvedOptions().timeZone || '',
        uuid
      ].join('||');
      const enc = new TextEncoder().encode(parts);
      const hashBuf = await crypto.subtle.digest('SHA-256', enc);
      return Array.from(new Uint8Array(hashBuf)).map(b => b.toString(16).padStart(2,'0')).join('');
    } catch(e) {
      return localStorage.getItem('training_device_uuid') || 'local-fallback';
    }
  }

  const fp = await getFingerprint();
  try {
    const allowed = localStorage.getItem('training_allowed_device');
    if(allowed && allowed !== fp){
      alert('This installation is locked to another device. Redirecting to login.');
      window.location.href = '/';
      return;
    }
  } catch(e){
    // ignore localStorage errors
  }

  // Check session with cookies (send credentials)
  try {
    const r = await fetch('/api/check_session', { credentials: 'include' });
    if(!r.ok){
      window.location.href = '/';
      return;
    }
    const j = await r.json();
    if(!j.logged_in){
      window.location.href = '/';
      return;
    }
    const short = fp ? fp.slice(0,8) : 'unknown';
    const statusEl = document.getElementById('status');
    statusEl.textContent = 'Device ID (short): ' + short + (j.is_admin ? ' — Admin' : '');
    if(j.is_admin){
      document.getElementById('adminLink').style.display = 'inline-block';
      sessionStorage.setItem('training_is_admin', '1');
    } else {
      sessionStorage.removeItem('training_is_admin');
    }
    document.getElementById('who').innerText = 'Welcome — device registered';
  } catch(e){
    console.error('session check failed', e);
    alert('Unable to verify session. Redirecting to login.');
    window.location.href = '/';
    return;
  }

  // Logout handler
  document.getElementById('logoutBtn').addEventListener('click', async ()=>{
    try {
      await fetch('/api/logout', { method: 'POST', credentials: 'include' });
    } catch(e){
      console.warn('logout network error', e);
    }
    sessionStorage.removeItem('training_is_admin');
    window.location.href = '/';
  });
})();
</script>
</body>
</html>